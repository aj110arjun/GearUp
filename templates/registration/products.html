{% extends "registration/base.html" %}
{% load static %}
{% block title %}GearUp - Home{% endblock title %}

{% block csslink %}
  <link rel="stylesheet" type="text/css" href="{% static 'css/products.css' %}">
  <style>
    
  </style>
{% endblock csslink %}

{% block content %}
<div class="container my-5">

  <form method="get" class="mb-4">
    <div class="row g-2 align-items-end">
      <div class="col-md-3">
        <label class="form-label text-dark">Search</label>
        <input type="text" name="search" value="{{ search_query }}" class="form-control" placeholder="Search by name">
      </div>
      <div class="col-md-2">
        <label class="form-label text-dark">Min Price</label>
        <input type="number" name="min_price" value="{{ min_price }}" class="form-control">
      </div>
      <div class="col-md-2">
        <label class="form-label text-dark">Max Price</label>
        <input type="number" name="max_price" value="{{ max_price }}" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="form-label text-dark">Sort By</label>
        <select name="sort" class="form-select">
          <option value="">-- Select --</option>
          <option value="price_asc" {% if sort_by == 'price_asc' %}selected{% endif %}>Price: Low to High</option>
          <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>Price: High to Low</option>
          <option value="name_asc" {% if sort_by == 'name_asc' %}selected{% endif %}>Name: A to Z</option>
          <option value="name_desc" {% if sort_by == 'name_desc' %}selected{% endif %}>Name: Z to A</option>
        </select>
      </div>
      <div class="col-md-2 d-flex gap-2">
        <button type="submit" class="btn btn-dark w-100">Apply</button>
        <a href="{% url 'product_list' %}" class="btn btn-outline-secondary">Reset</a>
      </div>
    </div>
  </form>

  <div class="row g-4 mt-3">
    {% for product in products %}
      <div class="col-sm-6 col-md-4 col-lg-3">
        <div class="product-card h-100 text-center">
          <img src="{{ product.image.url }}" class="product-img mb-3" alt="{{ product.name }}" />
          <h6 class="mb-1 text-dark fw-bold">{{ product.name | title }}</h6>
          <p class="price-tag">₹{{ product.price }}</p>
          <a href="{% url 'product_detail' slug=product.slug %}" class="card-btn mb-2">View</a>
          <div class="rating">★★★★★</div>
        </div>
      </div>
    {% empty %}
      <p>No products found matching your criteria.</p>
    {% endfor %}
  </div>

<div class="mt-4 d-flex justify-content-center">
  <nav>
    <ul class="pagination">

      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if min_price %}&min_price={{ min_price }}{% endif %}{% if max_price %}&max_price={{ max_price }}{% endif %}{% if sort_by %}&sort={{ sort_by }}{% endif %}{% if category_id %}&category={{ category_id }}{% endif %}">&laquo; First</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if min_price %}&min_price={{ min_price }}{% endif %}{% if max_price %}&max_price={{ max_price }}{% endif %}{% if sort_by %}&sort={{ sort_by }}{% endif %}{% if category_id %}&category={{ category_id }}{% endif %}">Previous</a>
        </li>
      {% endif %}

      <li class="page-item active"><a class="page-link" href="#">{{ page_obj.number }}</a></li>

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if min_price %}&min_price={{ min_price }}{% endif %}{% if max_price %}&max_price={{ max_price }}{% endif %}{% if sort_by %}&sort={{ sort_by }}{% endif %}{% if category_id %}&category={{ category_id }}{% endif %}">Next</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if min_price %}&min_price={{ min_price }}{% endif %}{% if max_price %}&max_price={{ max_price }}{% endif %}{% if sort_by %}&sort={{ sort_by }}{% endif %}{% if category_id %}&category={{ category_id }}{% endif %}">Last &raquo;</a>
        </li>
      {% endif %}

    </ul>
  </nav>
</div>
    
</div>
{% endblock content %}
